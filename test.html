<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <title>Numéro de Dossard</title>
    <meta http-equiv="content-Language" content="fr" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js" integrity="sha512-Qlv6VSKh1gDKGoJbnyA5RMXYcvnpIqhO++MhIM2fStMcGT9i2T//tSwYFlcyoRRDcDZ+TYHpH8azBBCyhpSeqw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <style>
      body {
        background-image: url('pn.png');
        background-repeat: no-repeat;
        background-attachment: fixed;
        background-size: cover;
            }
      </style>
</head>
<body> 
  
  <div id="result"></div>
  <script>

    //FORMULAIRE

    let numero = prompt("Numero du dossard :");

    //DOCUMENT CVS

    let contenu = `ID,type,inscription,Dossard,Nom,Prenom,DatedeN,Mug,TshirtS,TshirtM,TshirtL,TshirtXL,TshirtXXL
    994197487,MARATHONRUNINLYONBYHARMONIEMUTUELLE,MARATHONRUNINLYONBYHARMONIEMUTUELLE,1201,WIGNIOLLE,Nicolas,431980,1,,,,,
    977554888,MARATHONRUNINLYONBYHARMONIEMUTUELLE,MARATHONRUNINLYONBYHARMONIEMUTUELLE,2510,DONZÉ,Manuel,571971,,,1,,,
    991939487,MARATHONRUNINLYONBYHARMONIEMUTUELLE,MARATHONRUNINLYONBYHARMONIEMUTUELLE,2731,Cornet,Matthieu,351997,,1,,,,
    995975888,MARATHONRUNINLYONBYHARMONIEMUTUELLE,MARATHONRUNINLYONBYHARMONIEMUTUELLE,2865,Grandjer,Loïc,941969,1,,,,,
    977967687,MARATHONRUNINLYONBYHARMONIEMUTUELLE,MARATHONRUNINLYONBYHARMONIEMUTUELLE,3655,Kusz,David,4241970,2,,,,,
    985747681,MARATHONRUNINLYONBYHARMONIEMUTUELLE,MARATHONRUNINLYONBYHARMONIEMUTUELLE,3725,GASTINE,Jeanmarc,2161972,,,1,,,
    992061988,MARATHONRUNINLYONBYHARMONIEMUTUELLE,MARATHONRUNINLYONBYHARMONIEMUTUELLE,3815,Sauvaire,Samuel,2101991,1,,,,,
    995694081,PartenairesMARATHON,AutresdossardsMARATHON,4249,Boucher,Sandy,971978,1,,,,,`;

    //RECUPERATION DES DONNEES

    let lines = contenu.split("\n");
    for (let line of lines) {
        let cells = line.split(",");
        let ID = cells[0];
        let type = cells[1];
        let inscription = cells[2];
        let Dossard = cells[3];
        let Nom = cells[4];
        let Prenom = cells[5];
        let DatedeN = cells[6];
        let Mug = cells[7];
        let TshirtS = cells[8];
        let TshirtM = cells[9];
        let TshirtL = cells[10];
        let TshirtXL = cells[11];
        let TshirtXXL = cells[12];

        //TRI ET AFFICHAGE CONSOLE

        if (numero == Dossard) 
        {
            console.log("Numero : " + Dossard);
            console.log("Il y a : " + Mug + " mug");
            console.log("Il y a : " + TshirtS + " TshirtS");
            console.log("Il y a : " + TshirtM + " TshirtM");
            console.log("Il y a : " + TshirtL + " TshirtL");
            console.log("Il y a : " + TshirtXL + " TshirtXL");
            console.log("Il y a : " + TshirtXXL + " TshirtXXL");
            console.log(".................................");

            //ECRITURE DANS LE FICHIER

            document.write('<p style="text-align: center" </p>');
            document.write("Dans la commande " + Dossard + " on trouve : <br/>");
            document.write(Mug + " mug <br/>");
            document.write(TshirtS + " TshirtS <br/>");
            document.write(TshirtM + " TshirtM <br/>");
            document.write(TshirtL + " TshirtL <br/>");
            document.write(TshirtXL + " TshirtXL <br/>");
            document.write(TshirtXXL + " TshirtXXL <br/>");

            //TELECHARGEMENT FICHIER

            var myBlob = new Blob ([Nom + " " + Prenom],{type: "text/plain"});

            var url = window.URL.createObjectURL(myBlob);
            var anchor = document.createElement("a");
            anchor.href = url;
            anchor.download = "fichier.txt";

            anchor.click();
            window.URL.revokeObjectURL(url);
        }
    }

  </script>
</body>
</html>
